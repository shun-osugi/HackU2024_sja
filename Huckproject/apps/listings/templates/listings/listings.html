<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>出品画面</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <div class="container">
        <a href="{% url 'listings:create' %}">商品を出品する</a>

        <form method="POST" enctype="multipart/form-data" action="{% url 'listings:create' %}">
            {% csrf_token %}
            <div class="form-group">
                <label for="product_name">商品名:</label>
                <input type="text" id="product_name" name="product_name" placeholder="例: Javaの参考書" required>
            </div>

            <div class="form-group">
                <label for="subject">教科名:</label>
                <input type="text" id="subject" name="subject" placeholder="例: プログラミング基礎">
            </div>

            <div class="form-group">
                <label for="description">説明:</label>
                <textarea id="description" name="description" placeholder="商品の特徴や状態を記載してください" rows="4"></textarea>
            </div>

            <div class="form-group">
                <label for="price">価格 (円):</label>
                <input type="number" id="price" name="price" min="0" placeholder="例: 1500" required>
            </div>

            <div class="form-group">
                <label for="faculty">学部・学科:</label>
                <select id="faculty" name="faculty">
                    <option value="情報工学科">情報工学科</option>
                    <option value="機械工学科">機械工学科</option>
                    <option value="電気電子工学科">電気電子工学科</option>
                </select>
            </div>

            <div class="form-group">
                <label for="grade">学年:</label>
                <select id="grade" name="grade">
                    <option value="1">1年生</option>
                    <option value="2">2年生</option>
                    <option value="3">3年生</option>
                    <option value="4">4年生</option>
                </select>
            </div>

            <div class="form-group">
                <label for="image">画像アップロード:</label>
                <input type="file" id="image" name="image" accept="image/*" multiple>
                <div id="preview"></div>
            </div>

            <div class="form-group">
                <button type="submit" name="action" value="draft">下書き保存</button>
                <button type="submit" name="action" value="publish">出品する</button>
            </div>
        </form>
    </div>

    <script>
        // 画像プレビュー機能
        const imageInput = document.getElementById('image');
        const previewContainer = document.getElementById('preview');

        imageInput.addEventListener('change', () => {
            previewContainer.innerHTML = '';
            Array.from(imageInput.files).forEach(file => {
                const reader = new FileReader();
                reader.onload = e => {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.style.maxWidth = '100px';
                    img.style.margin = '5px';
                    previewContainer.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
        });
    </script>
</body>
</html>

